(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)})();
(function(){var a,b,c,d,e=[].slice,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var n in b)f.call(b,n)&&(a[n]=b[n]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a},k=function(a,b){return function(){return a.apply(b,arguments)}},m=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b=window.Morris={};a=jQuery;b.EventEmitter=function(){function a(){}a.prototype.on=function(a,b){null==this.handlers&&
(this.handlers={});null==this.handlers[a]&&(this.handlers[a]=[]);return this.handlers[a].push(b)};a.prototype.fire=function(){var a,b,c,d,t,p;b=arguments[0];a=2<=arguments.length?e.call(arguments,1):[];if(null!=this.handlers&&null!=this.handlers[b]){t=this.handlers[b];p=[];c=0;for(d=t.length;c<d;c++)b=t[c],p.push(b.apply(null,a));return p}};return a}();b.commas=function(a){var b,c;return null!=a?(c=0>a?"-":"",b=Math.abs(a),a=Math.floor(b).toFixed(0),c+=a.replace(/(?=(?:\d{3})+$)(?!^)/g,","),b=b.toString(),
b.length>a.length&&(c+=b.slice(a.length)),c):"-"};b.pad2=function(a){return(10>a?"0":"")+a};b.Grid=function(c){function d(b){var c=this;this.el="string"===typeof b.element?a(document.getElementById(b.element)):a(b.element);if(null==this.el||0===this.el.length)throw Error("Graph container element not found");"static"===this.el.css("position")&&this.el.css("position","relative");this.options=a.extend({},this.gridDefaults,this.defaults||{},b);"string"===typeof this.options.units&&(this.options.postUnits=
b.units);this.raphael=new Raphael(this.el[0]);this.elementHeight=this.elementWidth=null;this.dirty=!1;this.init&&this.init();this.setData(this.options.data);this.el.bind("mousemove",function(a){var b;b=c.el.offset();return c.fire("hovermove",a.pageX-b.left,a.pageY-b.top)});this.el.bind("mouseout",function(a){return c.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(a){var b;b=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];a=c.el.offset();c.fire("hover",b.pageX-
a.left,b.pageY-a.top);return b});this.postInit&&this.postInit()}g(d,c);d.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:"#aaa",gridStrokeWidth:0.5,gridTextColor:"#888",gridTextSize:12,hideHover:!1,yLabelFormat:null,numLines:5,padding:25,parseTime:!0,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"]};d.prototype.setData=
function(a,c){var d,h,e,l,f,g,k,q,z,r,v,x;null==c&&(c=!0);if(null==a||0===a.length)this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide();else if(r=this.cumulative?0:null,v=this.cumulative?0:null,0<this.options.goals.length&&(f=Math.min.apply(null,this.options.goals),l=Math.max.apply(null,this.options.goals),v=null!=v?Math.min(v,f):f,r=null!=r?Math.max(r,l):l),this.data=function(){var c,d,n;n=[];e=c=0;for(d=a.length;c<d;e=++c){k=a[e];g={};g.label=k[this.options.xkey];this.options.parseTime?
(g.x=b.parseDate(g.label),this.options.dateFormat?g.label=this.options.dateFormat(g.x):"number"===typeof g.label&&(g.label=(new Date(g.label)).toString())):g.x=e;q=0;var C=g,l=void 0,f=void 0,y=void 0,w=void 0,y=this.options.ykeys,w=[];h=l=0;for(f=y.length;l<f;h=++l)z=y[h],x=k[z],"string"===typeof x&&(x=parseFloat(x)),null!=x&&"number"!==typeof x&&(x=null),null!=x&&(this.cumulative?q+=x:null!=r?(r=Math.max(x,r),v=Math.min(x,v)):r=v=x),this.cumulative&&null!=q&&(r=Math.max(q,r),v=Math.min(q,v)),w.push(x);
C.y=w;n.push(g)}return n}.call(this),this.options.parseTime&&(this.data=this.data.sort(function(a,b){return(a.x>b.x)-(b.x>a.x)})),this.xmin=this.data[0].x,this.xmax=this.data[this.data.length-1].x,this.events=[],this.options.parseTime&&0<this.options.events.length&&(this.events=function(){var a,c,n,s;n=this.options.events;s=[];a=0;for(c=n.length;a<c;a++)d=n[a],s.push(b.parseDate(d));return s}.call(this),this.xmax=Math.max(this.xmax,Math.max.apply(null,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(null,
this.events))),this.xmin===this.xmax&&(this.xmin-=1,this.xmax+=1),this.ymin=this.yboundary("min",v),this.ymax=this.yboundary("max",r),this.ymin===this.ymax&&(v&&(this.ymin-=1),this.ymax+=1),this.yInterval=(this.ymax-this.ymin)/(this.options.numLines-1),this.precision=0<this.yInterval&&1>this.yInterval?-Math.floor(Math.log(this.yInterval)/Math.log(10)):0,this.dirty=!0,c)return this.redraw()};d.prototype.yboundary=function(a,b){var c;c=this.options["y"+a];return"string"===typeof c?"auto"===c.slice(0,
4)?5<c.length?(c=parseInt(c.slice(5),10),null==b?c:Math[a](b,c)):null!=b?b:0:parseInt(c,10):c};d.prototype._calc=function(){var a,b;b=this.el.width();a=this.el.height();if(this.elementWidth!==b||this.elementHeight!==a||this.dirty)if(this.elementWidth=b,this.elementHeight=a,this.dirty=!1,this.left=this.options.padding,this.right=this.elementWidth-this.options.padding,this.top=this.options.padding,this.bottom=this.elementHeight-this.options.padding,this.options.axes&&(a=Math.max(this.measureText(this.yAxisFormat(this.ymin),
this.options.gridTextSize).width,this.measureText(this.yAxisFormat(this.ymax),this.options.gridTextSize).width),this.left+=a,this.bottom-=1.5*this.options.gridTextSize),this.width=this.right-this.left,this.height=this.bottom-this.top,this.dx=this.width/(this.xmax-this.xmin),this.dy=this.height/(this.ymax-this.ymin),this.calc)return this.calc()};d.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy};d.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/
2:this.left+(a-this.xmin)*this.dx};d.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();this.drawGoals();this.drawEvents();if(this.draw)return this.draw()};d.prototype.drawGoals=function(){var a,b,c,d,h;d=this.options.goals;h=[];a=b=0;for(c=d.length;b<c;a=++b)a=d[a],h.push(this.drawGoal("M"+this.left+","+this.transY(a)+"H"+(this.left+this.width)));return h};d.prototype.drawEvents=function(){var a,b,c,d,h;d=this.events;h=[];a=b=0;for(c=d.length;b<c;a=++b)a=d[a],h.push(this.drawEvent("M"+
this.transX(a)+","+this.bottom+"V"+this.top));return h};d.prototype.drawGrid=function(){var a,b,c,d,h,e,l;if(!(!1===this.options.grid&&!1===this.options.axes)){a=this.ymin;b=this.ymax;l=[];c=h=a;for(e=this.yInterval;a<=b?h<=b:h>=b;c=h+=e)c=parseFloat(c.toFixed(this.precision)),d=this.transY(c),this.options.axes&&this.drawYAxisLabel(this.left-this.options.padding/2,d,this.yAxisFormat(c)),this.options.grid?l.push(this.drawGridLine("M"+this.left+","+d+"H"+(this.left+this.width))):l.push(void 0);return l}};
d.prototype.measureText=function(a,b){var c,d;null==b&&(b=12);d=this.raphael.text(100,100,a).attr("font-size",b);c=d.getBBox();d.remove();return c};d.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)};d.prototype.yLabelFormat=function(a){return"function"===typeof this.options.yLabelFormat?this.options.yLabelFormat(a):""+this.options.preUnits+b.commas(a)+this.options.postUnits};d.prototype.updateHover=function(a,b){var c,d;c=this.hitTest(a,b);if(null!=c)return(d=this.hover).update.apply(d,
c)};d.prototype.drawGoal=function(a){return this.raphael.path(a).attr("stroke",this.options.goalLineColors[i%this.options.goalLineColors.length]).attr("stroke-width",this.options.goalStrokeWidth)};d.prototype.drawEvent=function(a){return this.raphael.path(a).attr("stroke",this.options.eventLineColors[i%this.options.eventLineColors.length]).attr("stroke-width",this.options.eventStrokeWidth)};d.prototype.drawYAxisLabel=function(a,b,c){return this.raphael.text(a,b,c).attr("font-size",this.options.gridTextSize).attr("fill",
this.options.gridTextColor).attr("text-anchor","end")};d.prototype.drawGridLine=function(a){return this.raphael.path(a).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};return d}(b.EventEmitter);b.parseDate=function(a){var b,c,d,e,t,p;if("number"===typeof a)return a;c=a.match(/^(\d+) Q(\d)$/);e=a.match(/^(\d+)-(\d+)$/);t=a.match(/^(\d+)-(\d+)-(\d+)$/);b=a.match(/^(\d+) W(\d+)$/);d=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);p=
a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);return c?(new Date(parseInt(c[1],10),3*parseInt(c[2],10)-1,1)).getTime():e?(new Date(parseInt(e[1],10),parseInt(e[2],10)-1,1)).getTime():t?(new Date(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10))).getTime():b?(p=new Date(parseInt(b[1],10),0,1),4!==p.getDay()&&p.setMonth(0,1+(4-p.getDay()+7)%7),p.getTime()+6048E5*parseInt(b[2],10)):d?d[6]?(a=0,"Z"!==d[6]&&(a=60*parseInt(d[8],10)+parseInt(d[9],10),"+"===d[7]&&
(a=0-a)),Date.UTC(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10)+a)):(new Date(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10))).getTime():p?(d=parseFloat(p[6]),b=Math.floor(d),d=Math.round(1E3*(d-b)),p[8]?(a=0,"Z"!==p[8]&&(a=60*parseInt(p[10],10)+parseInt(p[11],10),"+"===p[9]&&(a=0-a)),Date.UTC(parseInt(p[1],10),parseInt(p[2],10)-1,parseInt(p[3],10),parseInt(p[4],10),parseInt(p[5],10)+a,b,d)):(new Date(parseInt(p[1],
10),parseInt(p[2],10)-1,parseInt(p[3],10),parseInt(p[4],10),parseInt(p[5],10),b,d)).getTime()):(new Date(parseInt(a,10),0,1)).getTime()};b.Hover=function(){function c(d){null==d&&(d={});this.options=a.extend({},b.Hover.defaults,d);this.el=a("<div class='"+this.options["class"]+"'></div>");this.el.hide();this.options.parent.append(this.el)}c.defaults={"class":"morris-hover morris-default-style"};c.prototype.update=function(a,b,c){this.html(a);this.show();return this.moveTo(b,c)};c.prototype.html=function(a){return this.el.html(a)};
c.prototype.moveTo=function(a,b){var c,d,e,p;p=this.options.parent.innerWidth();e=this.options.parent.innerHeight();d=this.el.outerWidth();c=this.el.outerHeight();d=Math.min(Math.max(0,a-d/2),p-d);null!=b?(p=b-c-10,0>p&&(p=b+10,p+c>e&&(p=e/2-c/2))):p=e/2-c/2;return this.el.css({left:d+"px",top:p+"px"})};c.prototype.show=function(){return this.el.show()};c.prototype.hide=function(){return this.el.hide()};return c}();b.Line=function(a){function c(a){this.hilight=k(this.hilight,this);this.onHoverOut=
k(this.onHoverOut,this);this.onHoverMove=k(this.onHoverMove,this);if(!(this instanceof b.Line))return new b.Line(a);c.__super__.constructor.call(this,a)}g(c,a);c.prototype.init=function(){this.pointGrow=Raphael.animation({r:this.options.pointSize+3},25,"linear");this.pointShrink=Raphael.animation({r:this.options.pointSize},25,"linear");if("always"!==this.options.hideHover)return this.hover=new b.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut)};c.prototype.defaults=
{lineWidth:3,pointSize:4,lineColors:"#0b62a4 #7A92A3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),pointWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:!0,xLabels:"auto",xLabelFormat:null,xLabelMargin:50,continuousLine:!0,hideHover:!1};c.prototype.calc=function(){this.calcPoints();return this.generatePaths()};c.prototype.calcPoints=function(){var a,c,b,d,e,h;e=this.data;h=[];b=0;for(d=e.length;b<d;b++)a=e[b],a._x=this.transX(a.x),a._y=function(){var b,d,e,h;e=a.y;h=[];b=0;
for(d=e.length;b<d;b++)c=e[b],null!=c?h.push(this.transY(c)):h.push(c);return h}.call(this),h.push(a._ymax=Math.min.apply(null,[this.bottom].concat(function(){var b,d,e,h;e=a._y;h=[];b=0;for(d=e.length;b<d;b++)c=e[b],null!=c&&h.push(c);return h}())));return h};c.prototype.hitTest=function(a,b){var c,d,e,h,f;if(0===this.data.length)return null;f=this.data.slice(1);c=e=0;for(h=f.length;e<h&&!(d=f[c],a<(d._x+this.data[c]._x)/2);c=++e);return c};c.prototype.onHoverMove=function(a,c){var b;b=this.hitTest(a,
c);return this.displayHoverForRow(b)};c.prototype.onHoverOut=function(){if("auto"===this.options.hideHover)return this.displayHoverForRow(null)};c.prototype.displayHoverForRow=function(a){var c;if(null!=a)return(c=this.hover).update.apply(c,this.hoverContentForRow(a)),this.hilight(a);this.hover.hide();return this.hilight()};c.prototype.hoverContentForRow=function(a){var c,b,d,e,h,f;b=this.data[a];if("function"===typeof this.options.hoverCallback)a=this.options.hoverCallback(a,this.options);else{a=
"<div class='morris-hover-row-label'>"+b.label+"</div>";f=b.y;c=e=0;for(h=f.length;e<h;c=++e)d=f[c],a+="<div class='morris-hover-point' style='color: "+this.colorFor(b,c,"label")+"'>\n  "+this.options.labels[c]+":\n  "+this.yLabelFormat(d)+"\n</div>"}return[a,b._x,b._ymax]};c.prototype.generatePaths=function(){var a,c,d,e,h;return this.paths=function(){var f,g,l,k;k=[];d=f=0;for(g=this.options.ykeys.length;0<=g?f<g:f>g;d=0<=g?++f:--f)h=!0===this.options.smooth||(l=this.options.ykeys[d],0<=m.call(this.options.smooth,
l)),c=function(){var a,c,b,n;b=this.data;n=[];a=0;for(c=b.length;a<c;a++)e=b[a],void 0!==e._y[d]&&n.push({x:e._x,y:e._y[d]});return n}.call(this),this.options.continuousLine&&(c=function(){var b,d,e;e=[];b=0;for(d=c.length;b<d;b++)a=c[b],null!==a.y&&e.push(a);return e}()),1<c.length?k.push(b.Line.createPath(c,h,this.bottom)):k.push(null);return k}.call(this)};c.prototype.draw=function(){this.options.axes&&this.drawXAxis();this.drawSeries();if(!1===this.options.hideHover)return this.displayHoverForRow(this.data.length-
1)};c.prototype.drawXAxis=function(){var a,c,d,e,h,f,g,l,k,q=this;f=this.bottom+1.25*this.options.gridTextSize;e=null;a=function(a,c){var b,d;b=q.drawXAxisLabel(q.transX(c),f,a);d=b.getBBox();return(null==e||e>=d.x+d.width)&&0<=d.x&&d.x+d.width<q.el.width()?e=d.x-q.options.xLabelMargin:b.remove()};d=this.options.parseTime?1===this.data.length&&"auto"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:b.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):
function(){var a,c,b,d;b=this.data;d=[];a=0;for(c=b.length;a<c;a++)h=b[a],d.push([h.label,h.x]);return d}.call(this);d.reverse();k=[];g=0;for(l=d.length;g<l;g++)c=d[g],k.push(a(c[0],c[1]));return k};c.prototype.drawSeries=function(){var a,c,b,d,e,h;for(c=e=h=this.options.ykeys.length-1;0>=h?0>=e:0<=e;c=0>=h?++e:--e)b=this.paths[c],null!==b&&this.drawLinePath(b,this.colorFor(d,c,"line"));this.seriesPoints=function(){var a,b,d;d=[];c=a=0;for(b=this.options.ykeys.length;0<=b?a<b:a>b;c=0<=b?++a:--a)d.push([]);
return d}.call(this);h=[];for(c=b=e=this.options.ykeys.length-1;0>=e?0>=b:0<=b;c=0>=e?++b:--b)h.push(function(){var b,e,h,f;h=this.data;f=[];b=0;for(e=h.length;b<e;b++)d=h[b],a=null!=d._y[c]?this.drawLinePoint(d._x,d._y[c],this.options.pointSize,this.colorFor(d,c,"point"),c):null,f.push(this.seriesPoints[c].push(a));return f}.call(this));return h};c.createPath=function(a,c,d){var e,h,f,g,l,k,q,m,r,v;q="";c&&(f=b.Line.gradients(a));m={y:null};g=r=0;for(v=a.length;r<v;g=++r){e=a[g];if(null!=e.y)if(null!=
m.y)c?(h=f[g],k=f[g-1],l=(e.x-m.x)/4,g=m.x+l,k=Math.min(d,m.y+l*k),m=e.x-l,h=Math.min(d,e.y-l*h),q+="C"+g+","+k+","+m+","+h+","+e.x+","+e.y):q+="L"+e.x+","+e.y;else if(!c||null!=f[g])q+="M"+e.x+","+e.y;m=e}return q};c.gradients=function(a){var c,b,d,e,h,f,g;b=function(a,c){return(a.y-c.y)/(a.x-c.x)};g=[];d=h=0;for(f=a.length;h<f;d=++h)c=a[d],null!=c.y?(e=a[d+1]||{y:null},d=a[d-1]||{y:null},null!=d.y&&null!=e.y?g.push(b(d,e)):null!=d.y?g.push(b(d,c)):null!=e.y?g.push(b(c,e)):g.push(null)):g.push(null);
return g};c.prototype.hilight=function(a){var c,b,d;if(null!==this.prevHilight&&this.prevHilight!==a){c=b=0;for(d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][this.prevHilight]&&this.seriesPoints[c][this.prevHilight].animate(this.pointShrink)}if(null!==a&&this.prevHilight!==a){c=b=0;for(d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][a]&&this.seriesPoints[c][a].animate(this.pointGrow)}return this.prevHilight=a};c.prototype.colorFor=
function(a,c,b){return"function"===typeof this.options.lineColors?this.options.lineColors.call(this,a,c,b):"point"===b?this.options.pointFillColors[c%this.options.pointFillColors.length]||this.options.lineColors[c%this.options.lineColors.length]:this.options.lineColors[c%this.options.lineColors.length]};c.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("fill",this.options.gridTextColor)};c.prototype.drawLinePath=function(a,
c){return this.raphael.path(a).attr("stroke",c).attr("stroke-width",this.options.lineWidth)};c.prototype.drawLinePoint=function(a,c,b,d,e){return this.raphael.circle(a,c,b).attr("fill",d).attr("stroke-width",this.strokeWidthForSeries(e)).attr("stroke",this.strokeForSeries(e))};c.prototype.strokeWidthForSeries=function(a){return this.options.pointWidths[a%this.options.pointWidths.length]};c.prototype.strokeForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]};
return c}(b.Grid);b.labelSeries=function(c,d,e,f,g){var k,p,w,y,m;k=200*(d-c)/e;e=new Date(c);f=b.LABEL_SPECS[f];if(void 0===f){m=b.AUTO_LABEL_ORDER;w=0;for(y=m.length;w<y;w++)if(p=m[w],p=b.LABEL_SPECS[p],k>=p.span){f=p;break}}void 0===f&&(f=b.LABEL_SPECS.second);g&&(f=a.extend({},f,{fmt:g}));g=f.start(e);for(e=[];(k=g.getTime())<=d;)k>=c&&e.push([f.fmt(g),k]),f.incr(g);return e};c=function(a){return{span:6E4*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())},
fmt:function(a){return""+b.pad2(a.getHours())+":"+b.pad2(a.getMinutes())},incr:function(c){return c.setMinutes(c.getMinutes()+a)}}};d=function(a){return{span:1E3*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())},fmt:function(a){return""+b.pad2(a.getHours())+":"+b.pad2(a.getMinutes())+":"+b.pad2(a.getSeconds())},incr:function(c){return c.setSeconds(c.getSeconds()+a)}}};b.LABEL_SPECS={decade:{span:1728E8,start:function(a){return new Date(a.getFullYear()-
a.getFullYear()%10,0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+10)}},year:{span:1728E7,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:24192E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(a){return""+a.getFullYear()+"-"+b.pad2(a.getMonth()+1)},incr:function(a){return a.setMonth(a.getMonth()+
1)}},day:{span:864E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+a.getFullYear()+"-"+b.pad2(a.getMonth()+1)+"-"+b.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+1)}},hour:c(60),"30min":c(30),"15min":c(15),"10min":c(10),"5min":c(5),minute:c(1),"30sec":d(30),"15sec":d(15),"10sec":d(10),"5sec":d(5),second:d(1)};b.AUTO_LABEL_ORDER="decade year month day hour 30min 15min 10min 5min minute 30sec 15sec 10sec 5sec second".split(" ");
b.Area=function(a){function c(a){if(!(this instanceof b.Area))return new b.Area(a);this.cumulative=!0;c.__super__.constructor.call(this,a)}g(c,a);c.prototype.calcPoints=function(){var a,c,b,d,e,h,f;h=this.data;f=[];d=0;for(e=h.length;d<e;d++){a=h[d];a._x=this.transX(a.x);c=0;for(var g=a,k=void 0,l=void 0,m=void 0,r=void 0,m=a.y,r=[],k=0,l=m.length;k<l;k++)b=m[k],c+=b||0,r.push(this.transY(c));g._y=r;f.push(a._ymax=a._y[a._y.length-1])}return f};c.prototype.drawSeries=function(){var a,b,d,e;for(a=
d=e=this.options.ykeys.length-1;0>=e?0>=d:0<=d;a=0>=e?++d:--d)b=this.paths[a],null!==b&&(b+="L"+this.transX(this.xmax)+","+this.bottom+"L"+this.transX(this.xmin)+","+this.bottom+"Z",this.drawFilledPath(b,this.fillForSeries(a)));return c.__super__.drawSeries.call(this)};c.prototype.fillForSeries=function(a){a=Raphael.rgb2hsl(this.colorFor(this.data[a],a,"line"));return Raphael.hsl(a.h,Math.min(255,0.75*a.s),Math.min(255,1.25*a.l))};c.prototype.drawFilledPath=function(a,c){return this.raphael.path(a).attr("fill",
c).attr("stroke-width",0)};return c}(b.Line);b.Bar=function(c){function d(c){this.onHoverOut=k(this.onHoverOut,this);this.onHoverMove=k(this.onHoverMove,this);if(!(this instanceof b.Bar))return new b.Bar(c);d.__super__.constructor.call(this,a.extend({},c,{parseTime:!1}))}g(d,c);d.prototype.init=function(){this.cumulative=this.options.stacked;if("always"!==this.options.hideHover)return this.hover=new b.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut)};
d.prototype.defaults={barSizeRatio:0.75,barGap:3,barColors:"#0b62a4 #7a92a3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),xLabelMargin:50};d.prototype.calc=function(){var a;this.calcBars();if(!1===this.options.hideHover)return(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1))};d.prototype.calcBars=function(){var a,c,b,d,e,f,h;f=this.data;h=[];a=d=0;for(e=f.length;d<e;a=++d)c=f[a],c._x=this.left+this.width*(a+0.5)/this.data.length,h.push(c._y=function(){var a,d,e,f;e=
c.y;f=[];a=0;for(d=e.length;a<d;a++)b=e[a],null!=b?f.push(this.transY(b)):f.push(null);return f}.call(this));return h};d.prototype.draw=function(){this.options.axes&&this.drawXAxis();return this.drawSeries()};d.prototype.drawXAxis=function(){var a,c,b,d,e,f,h;d=this.bottom+1.25*this.options.gridTextSize;b=null;h=[];a=e=0;for(f=this.data.length;0<=f?e<f:e>f;a=0<=f?++e:--e)a=this.data[this.data.length-1-a],a=this.drawXAxisLabel(a._x,d,a.label),c=a.getBBox(),(null==b||b>=c.x+c.width)&&0<=c.x&&c.x+c.width<
this.el.width()?h.push(b=c.x-this.options.xLabelMargin):h.push(a.remove());return h};d.prototype.drawSeries=function(){var a,c,b,d,e,f,h,g,k,l,m,r,v,x;b=this.width/this.options.data.length;g=null!=this.options.stacked?1:this.options.ykeys.length;a=(b*this.options.barSizeRatio-this.options.barGap*(g-1))/g;h=b*(1-this.options.barSizeRatio)/2;x=0>=this.ymin&&0<=this.ymax?this.transY(0):null;return this.bars=function(){var g,D,A,B;A=this.data;B=[];d=g=0;for(D=A.length;g<D;d=++g)k=A[d],e=0,B.push(function(){var g,
D,A,E;A=k._y;E=[];l=g=0;for(D=A.length;g<D;l=++g)v=A[l],null!==v?(x?(r=Math.min(v,x),c=Math.max(v,x)):(r=v,c=this.bottom),f=this.left+d*b+h,this.options.stacked||(f+=l*(a+this.options.barGap)),m=c-r,this.options.stacked&&(r-=e),this.drawBar(f,r,a,m,this.colorFor(k,l,"bar")),E.push(e+=m)):E.push(null);return E}.call(this));return B}.call(this)};d.prototype.colorFor=function(a,c,b){return"function"===typeof this.options.barColors?(a={x:a.x,y:a.y[c],label:a.label},c={index:c,key:this.options.ykeys[c],
label:this.options.labels[c]},this.options.barColors.call(this,a,c,b)):this.options.barColors[c%this.options.barColors.length]};d.prototype.hitTest=function(a,c){if(0===this.data.length)return null;a=Math.max(Math.min(a,this.right),this.left);return Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length)))};d.prototype.onHoverMove=function(a,c){var b,d;b=this.hitTest(a,c);return(d=this.hover).update.apply(d,this.hoverContentForRow(b))};d.prototype.onHoverOut=function(){if("auto"===
this.options.hideHover)return this.hover.hide()};d.prototype.hoverContentForRow=function(a){var c,b,d,e,f,h,g;if("function"===typeof this.options.hoverCallback)c=this.options.hoverCallback(a,this.options);else{d=this.data[a];c="<div class='morris-hover-row-label'>"+d.label+"</div>";g=d.y;b=f=0;for(h=g.length;f<h;b=++f)e=g[b],c+="<div class='morris-hover-point'> <span class='label-1'><strong class='language' style='background-color: "+this.colorFor(d,b,"label")+"'>\n "+this.options.labels[b]+":\n </strong></span><span> "+
this.yLabelFormat(e)+"\n</span></div>"}return[c,this.left+(a+0.5)*this.width/this.data.length]};d.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("fill",this.options.gridTextColor)};d.prototype.drawBar=function(a,c,b,d,e){return this.raphael.rect(a,c,b,d).attr("fill",e).attr("stroke-width",0)};return d}(b.Grid);b.Donut=function(){function c(d){this.select=k(this.select,this);if(!(this instanceof b.Donut))return new b.Donut(d);
this.el="string"===typeof d.element?a(document.getElementById(d.element)):a(d.element);this.options=a.extend({},this.defaults,d);if(null===this.el||0===this.el.length)throw Error("Graph placeholder not found.");void 0===d.data||0===d.data.length||(this.data=d.data,this.redraw())}c.prototype.defaults={colors:"#0B62A4 #3980B5 #679DC6 #95BBD7 #B0CCE1 #095791 #095085 #083E67 #052C48 #042135".split(" "),backgroundColor:"#FFFFFF",labelColor:"#000000",valueColor:"#000000",formatter:b.commas};c.prototype.redraw=
function(){var a,c,d,e,f,g,k,l,m,u,q,z,r;this.el.empty();this.raphael=new Raphael(this.el[0]);c=this.el.width()/2;d=this.el.height()/2;u=(Math.min(c,d)-10)/3;m=0;l=this.data;a=0;for(k=l.length;a<k;a++)f=l[a],m+=f.value;k=5/(2*u);a=1.9999*Math.PI-k*this.data.length;f=g=0;this.segments=[];r=this.data;q=0;for(z=r.length;q<z;q++)e=r[q],l=g+k+a*(e.value/m),g=new b.DonutSegment(c,d,2*u,u,g,l,this.options.colors[f%this.options.colors.length],this.options.backgroundColor,e,this.raphael),g.render(),this.segments.push(g),
g.on("hover",this.select),g=l,f+=1;this.text1=this.drawEmptyDonutLabel(c,d-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(c,d+10,this.options.valueColor,14,800);c=Math.max.apply(null,function(){var a,c,b,d;b=this.data;d=[];a=0;for(c=b.length;a<c;a++)e=b[a],d.push(e.value);return d}.call(this));f=0;u=this.data;a=[];d=0;for(m=u.length;d<m;d++){e=u[d];if(e.value===c){this.select(f);break}a.push(f+=1)}return a};c.prototype.select=function(a){var c,b,d,e;e=this.segments;b=0;for(d=
e.length;b<d;b++)c=e[b],c.deselect();a="number"===typeof a?this.segments[a]:a;a.select();return this.setLabels(a.data.label,this.options.formatter(a.data.value,a.data))};c.prototype.setLabels=function(a,c){var b,d,e,f;b=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3;e=1.8*b;d=b/2;b/=3;this.text1.attr({text:a,transform:""});f=this.text1.getBBox();d=Math.min(e/f.width,d/f.height);this.text1.attr({transform:"S"+d+","+d+","+(f.x+f.width/2)+","+(f.y+f.height)});this.text2.attr({text:c,transform:""});
d=this.text2.getBBox();e=Math.min(e/d.width,b/d.height);return this.text2.attr({transform:"S"+e+","+e+","+(d.x+d.width/2)+","+d.y})};c.prototype.drawEmptyDonutLabel=function(a,c,b,d,e){a=this.raphael.text(a,c,"").attr("font-size",d).attr("fill",b);null!=e&&a.attr("font-weight",e);return a};return c}();b.DonutSegment=function(a){function c(a,b,d,e,f,g,h,l,m,q){this.cx=a;this.cy=b;this.inner=d;this.outer=e;this.color=h;this.backgroundColor=l;this.data=m;this.raphael=q;this.deselect=k(this.deselect,
this);this.select=k(this.select,this);this.sin_p0=Math.sin(f);this.cos_p0=Math.cos(f);this.sin_p1=Math.sin(g);this.cos_p1=Math.cos(g);this.is_long=g-f>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}g(c,a);c.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,this.cy+a*this.cos_p1]};c.prototype.calcSegment=
function(a,c){var b,d,e,f,g;f=this.calcArcPoints(a);b=f[0];e=f[1];d=f[2];f=f[3];g=this.calcArcPoints(c);return"M"+b+","+e+("A"+a+","+a+",0,"+this.is_long+",0,"+d+","+f)+("L"+g[2]+","+g[3])+("A"+c+","+c+",0,"+this.is_long+",1,"+g[0]+","+g[1])+"Z"};c.prototype.calcArc=function(a){var c;c=this.calcArcPoints(a);return"M"+c[0]+","+c[1]+("A"+a+","+a+",0,"+this.is_long+",0,"+c[2]+","+c[3])};c.prototype.render=function(){var a=this;this.arc=this.drawDonutArc(this.hilight,this.color);return this.seg=this.drawDonutSegment(this.path,
this.color,this.backgroundColor,function(){return a.fire("hover",a)})};c.prototype.drawDonutArc=function(a,c){return this.raphael.path(a).attr({stroke:c,"stroke-width":2,opacity:0})};c.prototype.drawDonutSegment=function(a,c,b,d){return this.raphael.path(a).attr({fill:c,stroke:b,"stroke-width":3}).hover(d)};c.prototype.select=function(){if(!this.selected)return this.seg.animate({path:this.selectedPath},150,"<>"),this.arc.animate({opacity:1},150,"<>"),this.selected=!0};c.prototype.deselect=function(){if(this.selected)return this.seg.animate({path:this.path},
150,"<>"),this.arc.animate({opacity:0},150,"<>"),this.selected=!1};return c}(b.EventEmitter)}).call(this);
(function(){var a={};this.tmpl=function c(d,e){var f=!/\W/.test(d)?a[d]=a[d]||c(document.getElementById(d).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return e?f(e):f}})();jQuery.extend(jQuery.ns("Kattis.API"),{ajax_session_edit:"/ajax/session",ajax_session_banner:"/ajax/session/banner",ajax_session_judge:"/ajax/session/judge",ajax_session_problem:"/ajax/session/problem",ajax_session_team:"/ajax/session/team",ajax_session_team_member:"/ajax/session/team/member",ajax_session_short_name_available:"/ajax/session/short-name-available",ajax_session_publish:"/ajax/session/publish",ajax_author:"/ajax/author",ajax_course_offering_teacher:"/ajax/course_offering/teacher",ajax_course_offering_short_name_available:"/ajax/course_offering/short-name-available",
user_view:"/users",course_problemgroup_edit:"/courses/{0}/{1}/problemgroups/{2}/edit"});jQuery.extend(jQuery.ns("Kattis.util"),{isValidDate:function(a){var b=a.match(/^(\d\d\d\d)-(\d\d)-(\d\d)$/);if(null===b)return!1;a=parseInt(b[1]);var c=parseInt(b[2]),b=parseInt(b[3]);if(1970>a||2100<a||0==c||12<c)return!1;var d=[31,28,31,30,31,30,31,31,30,31,30,31];if(0==a%400||0!=a%100&&0==a%4)d[1]=29;return 0<b&&b<=d[c-1]},isValidTime:function(a){var b=a.match(/^(\d\d):(\d\d)(:(\d\d))?$/);if(null===b)return!1;a=parseInt(b[1]);var c=parseInt(b[2]),b=void 0===b[4]?null:parseInt(b[4]);return 24>a&&
60>c&&(null===b||60>b)}});jQuery.extend(jQuery.ns("Kattis.views.contest.edit"),{MAX_INT_32:Math.pow(2,31)-1,MAX_UNPRIVILEGED_DURATION:604800,init:function(){this.shortnameValid=this.timehintsValid=!0;this.btnCreateSession=jQuery("#create-btn");this.btnCreateSession.bind("click",this.createSession.bind(this));this.txtStartTime=jQuery("#start-time");this.spanStartHint=jQuery("#start-hint");this.startTimeVal=null;this.txtStartTime.bind("change keyup input",this.modifyTimeHints.bind(this));this.txtDuration=jQuery("#duration");
this.spanFinishHint=jQuery("#finish-hint");this.durationVal=null;this.txtDuration.bind("change keyup input",this.modifyTimeHints.bind(this));this.sessionNameHint=jQuery("#session-name-hint");(this.sessionNameValid=this.data.existing)||this.sessionNameHint.text("Name can't be empty");jQuery("#session-name").on("change keyup input",this.modifySessionNameHint.bind(this));this.data.is_privileged&&(this.txtCutoff=jQuery("#cutoff"),this.spanCutoffHint=jQuery("#cutoff-hint"),this.cutoffVal=null,this.txtCutoff.bind("change keyup input",
this.modifyTimeHints.bind(this)),this.txtShortName=jQuery("#short-name"),this.spanShortNameHint=jQuery("#short-name-hint"),this.txtShortName.bind("change keyup input",this.onContestShortNameChange.bind(this)),jQuery("#remove-banner").bind("click",this.onRemoveBannerClick.bind(this)));if(this.data.existing){this.btnPublishSession=jQuery("#publish-btn");this.spanPublishProgress=jQuery("#publish-progress");this.btnPublishSession.bind("click",this.publishSession.bind(this));jQuery("#basic-settings").on("change input",
":input",this.onBasicSettingChange.bind(this));jQuery("#tblProblems").on("mousedown mouseup",".dndhandle",function(){jQuery(this).toggleClass("grab grabbing")});jQuery("#add-problem-btn").bind("click",this.onAddProblem.bind(this));jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").bind("change keyup input",this.onProblemNameAvalabilityChange.bind(this));jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").keypress(function(a){13==
a.keyCode&&!jQuery("#add-problem-btn").prop("disabled")&&jQuery("#add-problem-btn").click()});this.resetProblems();this.setUpProblemsSorting();this.data.is_privileged&&(this.tbodyJudge=jQuery("#tblJudges tbody"),this.judge_tmpl=tmpl("judge_tmpl"),jQuery("#add-judge-btn").bind("click",this.onAddJudge.bind(this)),jQuery("#add-judge-username").bind("change keyup input",function(){jQuery("#add-judge-btn").prop("disabled",""===jQuery(this).val())}),jQuery("#add-judge-username").keypress(function(a){13==
a.keyCode&&!jQuery("#add-judge-btn").prop("disabled")&&jQuery("#add-judge-btn").click()}),this.data.judges.forEach(this.addJudgeRow,this));this.tbodyTeam=jQuery("#tblTeams tbody");this.team_tmpl=tmpl("team_tmpl");this.team_member_tmpl=tmpl("team_member_tmpl");this.autoaccept=!1;this.tbodyTeam.on("click","input.team-member-accepted",function(a){this.autoaccept=jQuery(a.target).is(":checked");this.tbodyTeam.find("input.team-member-accepted").prop("checked",this.autoaccept)}.bind(this));jQuery("#add-team-btn").bind("click",
this.onAddTeam.bind(this));jQuery("#add-team-name"+(this.data.is_privileged?", #add-team-penalty":"")).keyup(function(a){13==a.keyCode&&!jQuery("#add-team-btn").prop("disabled")&&jQuery("#add-team-btn").click()});jQuery(document).on("focusin",function(a){var b=a.target;jQuery("#tblTeams tbody tr").has(".team-edit:hidden").each(function(){jQuery(this).has(b).length||jQuery(this).find(".team-done").click()})});this.data.teams.forEach(this.addTeamRow,this);var a=this,b=jQuery("#add-problem-available-from");
jQuery(".enable-add-problem-popover").popover({placement:"top",html:!0,container:"body",content:'<input type="text" class="form-control problem-available-date">'}).on("show.bs.popover",function(){b.prop("disabled",!0)}).on("hide.bs.popover",function(){b.prop("disabled",!1)}).on("shown.bs.popover",function(){var c=a.getTimeFromString(a.startTimeVal),d=b.val().split(":"),e=d[1],d=d[0],f=jQuery(".problem-available-date");"infinity"!==c&&null!==c&&(e=new Date(c.getTime()+6E4*e+36E5*d),f.val(a.getTimeStringFromDateObject(e)));
f.on("change keyup paste",function(){if("infinity"!==c&&null!==c){var d=a.getTimeFromString(f.val());null!==d&&(d-=c,0<=d&&b.val(parseInt(d/36E5)+":"+a.leftBinPad(parseInt(d/6E4)%60)))}})})}this.modifyTimeHints();jQuery("body").on("hidden.bs.popover",function(a){jQuery(a.target).data("bs.popover").inState.click=!1})},leftBinPad:function(a){return 10>a?"0"+a:a},getTimeStringFromDateObject:function(a){var b=this.leftBinPad;return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+" "+
b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())},modifySessionNameHint:function(a){""===jQuery(a.target).val().trim()?(this.sessionNameHint.text("Name can't be empty"),this.sessionNameValid=!1):(this.sessionNameHint.text(""),this.sessionNameValid=!0);this.updateSaveButton()},isValid:function(){return this.timehintsValid&&this.shortnameValid&&this.sessionNameValid},updateSaveButton:function(a){a=void 0===a?this.isValid():a;this.btnCreateSession.prop("disabled",!a);this.data.existing&&
(a?jQuery("#unsaved-changes").removeClass("hidden"):jQuery("#unsaved-changes").addClass("hidden"))},onBasicSettingChange:function(a){jQuery(a.target).closest("div.form-group").addClass("has-warning");this.updateSaveButton()},onProblemNameAvalabilityChange:function(){var a=!0;""===jQuery("#add-problem-name").val()&&(a=!1);this.data.is_privileged&&null===this.parse_formatted_interval(jQuery("#add-problem-available-from").val())&&(a=!1);jQuery("#add-problem-btn").prop("disabled",!a)},setUpProblemsSorting:function(){jQuery("#tblProblems tbody").sortable({handle:"> .dndhandle",
items:"> tr",helper:function(a,b){b.parent().children().children().each(function(){jQuery(this).width(jQuery(this).width())});return b},update:function(a,b){var c={short_name:this.data.short_name,problem_name:b.item.attr("data-name"),index:b.item.index(),csrf_token:this.data.csrf_token};jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(c),context:this}).done(function(a){this.replaceProblems(a.response.problems)}).fail(function(a){var c=
b.item.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code);this.resetProblems()})}.bind(this)})},onContestShortNameChange:function(){this.call_id=(this.call_id||0)+1;this.hintTimeout&&(clearTimeout(this.hintTimeout),this.hintTimeout=null);this.data.short_name===this.txtShortName.val()?(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin").addClass("glyphicon glyphicon-ok text-success"),this.data.existing&&
this.btnPublishSession.prop("disabled",!1),this.shortnameValid=!0,this.updateSaveButton()):""===this.txtShortName.val()?(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin"),this.shortnameValid=!0,this.updateSaveButton()):(this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin").addClass("fa fa-spinner fa-spin"),this.updateSaveButton(!1),this.data.existing&&
this.btnPublishSession.prop("disabled",!0),this.hintTimeout=setTimeout(function(a){jQuery.ajax({type:"GET",url:Kattis.API.ajax_session_short_name_available,data:{name:this.txtShortName.val()},context:this}).always(function(){this.spanShortNameHint.removeClass("glyphicon glyphicon-ok text-success glyphicon glyphicon-remove text-danger fa fa-spinner fa-spin")}).done(function(b){a===this.call_id&&(this.shortnameValid=b.response.available,this.spanShortNameHint.addClass(this.shortnameValid?"glyphicon glyphicon-ok text-success":
"glyphicon glyphicon-remove text-danger"),this.updateSaveButton())}).fail(function(){a===this.call_id&&(this.shortnameValid=!1,this.spanShortNameHint.addClass("glyphicon glyphicon-remove text-danger"),this.updateSaveButton())})}.bind(this),750,this.call_id))},problem_tmpl:function(a){var b=tmpl("problem_tmpl");a.format_minutes=this.format_minutes;return b(a)},onAddProblem:function(a){var b=jQuery(a.target);jQuery("#add-problem-btn, #add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").prop("disabled",
!0);a={short_name:this.data.short_name,problem_name:jQuery("#add-problem-name").val(),color_name:jQuery("#add-problem-color-name").val(),rgb:jQuery("#add-problem-color-rgb").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.available_in_session_from=this.parse_formatted_interval(jQuery("#add-problem-available-from").val()));jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){jQuery("#add-problem-name, #add-problem-available-from, #add-problem-color-name, #add-problem-color-rgb").prop("disabled",
!1);jQuery("#add-problem-name").focus();jQuery(".enable-add-problem-popover").popover("hide")}).done(function(a){jQuery("#add-problem-name").val("");jQuery("#add-problem-available-from").val("0:00");jQuery("#add-problem-color-name").val("");jQuery("#add-problem-color-rgb").val("");this.replaceProblems(a.response.problems)}).fail(function(a){b.prop("disabled",!1);var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)})},onAddJudge:function(a){var b=jQuery(a.target);0<this.tbodyJudge.find("[data-username='"+
jQuery("#add-judge-username").val()+"']").length?alert(b.attr("data-nonunique-msg")):(b.prop("disabled",!0),a={short_name:this.data.short_name,username:jQuery("#add-judge-username").val(),may_clarify:jQuery("#add-judge-may-clarify").is(":checked"),csrf_token:this.data.csrf_token},jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){jQuery("#add-judge-username").focus()}).done(function(a){jQuery("#add-judge-username").val("");
jQuery("#add-judge-may-clarify").prop("checked",!0);this.addJudgeRow(a.response,!0)}).fail(function(a){b.prop("disabled",!1);var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)}))},onAddTeam:function(a){var b=jQuery(a.target),c=b.closest("tr").find(":input");c.prop("disabled",!0);a={short_name:this.data.short_name,team_name:jQuery("#add-team-name").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.penalty_adjustment=jQuery("#add-team-penalty").val());
jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){c.prop("disabled",!1)}).done(function(a){jQuery("#add-team-name").val("");this.data.is_privileged&&jQuery("#add-team-penalty").val(0);this.addTeamRow(a.response.team,!0,!0)}).fail(function(a){var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},onRemoveBannerClick:function(a){var b=jQuery(a.target);b.prop("disabled",!0);jQuery.ajax({type:"DELETE",
url:Kattis.API.ajax_session_banner,contentType:"application/json",data:JSON.stringify({short_name:this.data.short_name,csrf_token:this.data.csrf_token})}).always(function(){b.prop("disabled",!1)}).done(function(){b.hide();jQuery("#session_banner").remove()}).fail(function(a){var d=b.data("fail-msg");Kattis.error.show_msg(d+": ",a.responseJSON.error.code)})},createSession:function(){this.btnCreateSession.prop("disabled",!0);var a=this.getSessionTimeUTC();if(null!==a){var b={session_name:jQuery("#session-name").val().trim(),
start_time:"infinity"===a?"infinity":a.toISOString(),duration:this.parse_formatted_interval(this.txtDuration.val()),is_open:jQuery("#is-open").is(":checked"),session_abbreviated_name:jQuery("#session-abbreviated-name").val(),csrf_token:this.data.csrf_token};this.data.existing&&jQuery.extend(b,{old_short_name:this.data.short_name});this.data.is_privileged&&jQuery.extend(b,{cutoff:this.parse_formatted_interval(this.txtCutoff.val()),short_name:this.txtShortName.val(),is_ranked:jQuery("#is-ranked").is(":checked"),
show_first_to_solve:jQuery("#show-first-to-solve").is(":checked"),show_group_leaders:jQuery("#show-group-leaders").is(":checked"),show_flags:jQuery("#show-flags").is(":checked"),show_logos:jQuery("#show-logos").is(":checked"),submission_penalty:jQuery("#submission-penalty").val(),scoreboard_limit:jQuery("#scoreboard-limit").val(),scoreboard_submission_threshold:jQuery("#scoreboard-submission-threshold").val(),scoreboard_solved_threshold:jQuery("#scoreboard-solved-threshold").val(),timestep_in_seconds:jQuery("#timestep-in-seconds").val(),
autofinalize:jQuery("#autofinalize").is(":checked"),classification:jQuery("#classification").val()});if(this.data.is_privileged)if(b.banner_image=null,a=document.getElementById("banner-image"),a.files&&a.files[0]){var c=new FileReader;c.onload=function(a){b.banner_image=btoa(a.target.result);this.internalCreateSession(b)}.bind(this);c.readAsBinaryString(a.files[0])}else this.internalCreateSession(b);else this.internalCreateSession(b)}},internalCreateSession:function(a){jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_edit,
contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){this.btnCreateSession.prop("disabled",!1)}).done(function(a){window.location.replace(a.response.redirect)}).fail(function(a){var c=this.btnCreateSession.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},publishSession:function(){confirm("Are you sure you want to publish? Publishing cannot be undone.")&&(this.btnPublishSession.prop("disabled",!0),this.spanPublishProgress.html('<i class="fa fa-spinner fa-spin"></i>'),
jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_publish,contentType:"application/json",data:JSON.stringify({csrf_token:this.data.csrf_token,short_name:this.data.short_name}),context:this}).done(function(){this.spanPublishProgress.html('<i class="glyphicon glyphicon-ok"></i>');window.location.reload(!0)}).fail(function(a){this.spanPublishProgress.html('<i class="glyphicon glyphicon-remove"></i>');this.btnPublishSession.prop("disabled",!1);var b=this.btnPublishSession.data("fail-msg");Kattis.error.show_msg(b+
": ",a.responseJSON.error.code)}))},getTimeFromString:function(a){if(!/^\d\d\d\d-\d\d-\d\d \d\d:\d\d(:\d\d)?$/.test(a))return null;var b=a.split(" ");a=b[0];b=b[1];return!Kattis.util.isValidDate(a)||!Kattis.util.isValidTime(b)?null:new Date(a+"T"+b+"Z")},getSessionTimeUTC:function(){var a=this.txtStartTime.val();return"infinity"===a?a:this.getTimeFromString(a)},isInt:function(a){return!isNaN(a)&&parseInt(Number(a))==a&&!isNaN(parseInt(a,10))},parse_formatted_minutes:function(a){var b=a.split(":");
if(2!==b.length)return null;a=b[0];b=b[1];if(!this.isInt(a)||!this.isInt(b)||!a.match(/^\d+$/)||!b.match(/^\d\d$/))return null;a=parseInt(a,10);b=parseInt(b,10);return 0>a||0>b||60<=b?null:60*a+b},parse_formatted_interval:function(a){if(!/^\d+:\d\d(:\d\d)?$/.test(a))return null;var b=a.split(":");if(2===b.length)return b=this.parse_formatted_minutes(a),null===b||60*b>this.MAX_INT_32?null:60*b;a=this.parse_formatted_minutes([b[0],b[1]].join(":"));b=b[2];if(null===a||!this.isInt(b))return null;b=parseInt(b,
10);if(0>b||60<=b)return null;b=60*a+b;return b>this.MAX_INT_32?null:b},format_minutes:function(a){a=Math.floor(a);return Math.floor(a/60)+":"+twodigit(a%60)},areTimeFieldsChanged:function(){return this.startTimeVal!==this.txtStartTime.val()||this.durationVal!==this.txtDuration.val()||this.data.is_privileged&&this.cutoffVal!==this.txtCutoff.val()?!0:!1},validateStartTime:function(){var a=this.getSessionTimeUTC();if(null===a)return this.spanStartHint.text("Invalid start time"),this.spanFinishHint.text("Invalid start time"),
this.data.is_privileged&&this.spanCutoffHint.text("Invalid start time"),!1;this.spanStartHint.text(a.toString());return!0},validateDuration:function(){var a=this.parse_formatted_interval(this.txtDuration.val());if(null===a)return this.spanFinishHint.text("Invalid duration"),this.data.is_privileged&&this.spanCutoffHint.text("Invalid duration"),!1;if(!this.data.is_privileged&&a>this.MAX_UNPRIVILEGED_DURATION)return this.spanFinishHint.text("Maximal duration is limited to 168 hours"),!1;var b=this.getSessionTimeUTC(),
a="infinity"===b?"infinity":new Date(b.getTime()+1E3*a);this.spanFinishHint.text(a.toString());return!0},validateCutoff:function(){if(!this.data.is_privileged)return!0;var a=this.parse_formatted_interval(this.txtDuration.val()),b=this.parse_formatted_interval(this.txtCutoff.val());if(null===b||b>a)return this.spanCutoffHint.text("Invalid cutoff"),!1;if(0===b)this.spanCutoffHint.text("None");else{var c=this.getSessionTimeUTC();"infinity"===c?b="infinity":(a=new Date(c.getTime()+1E3*a),b=new Date(a.getTime()-
1E3*b));this.spanCutoffHint.text(b.toString())}return!0},modifyTimeHints:function(){this.areTimeFieldsChanged()&&(this.timehintsValid=!0,this.startTimeVal=this.txtStartTime.val(),this.durationVal=this.txtDuration.val(),this.data.is_privileged&&(this.cutoffVal=this.txtCutoff.val()),[this.validateStartTime,this.validateDuration,this.validateCutoff].forEach(function(a){this.timehintsValid&&(this.timehintsValid=a.call(this))},this),this.data.existing||this.updateSaveButton())},addProblemRow:function(a,
b){var c=jQuery(this.problem_tmpl(a)),d=b?c.children("td").children("div"):jQuery();c.find(".problem-remove").bind("click",this.removeProblem.bind(this));d.attr("style","display: none;");jQuery("#tblProblems tbody").append(c);d.slideDown("fast")},removeProblem:function(a){var b=jQuery(a.target);a=b.closest("tr");var c=b.closest("tr").find(":input");c.prop("disabled",!0);a={short_name:this.data.short_name,problem_name:a.attr("data-name"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",
url:Kattis.API.ajax_session_problem,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(a){this.replaceProblems(a.response.problems)}).fail(function(a){c.prop("disabled",!1);var e=b.data("fail-msg");Kattis.error.show_msg(e+": ",a.responseJSON.error.code);this.resetProblems()})},resetProblems:function(){jQuery("#tblProblems tbody").empty();this.data.selected_problems.forEach(this.addProblemRow,this);var a=jQuery(this.data.all_problem_names).not(jQuery.map(this.data.selected_problems,
function(a){return a.name})).get();jQuery("#problems").replaceWith(jQuery('<datalist id="problems" />').append(jQuery.map(a,function(a){return jQuery("<option />").attr("value",a)})))},replaceProblems:function(a){this.data.selected_problems=a;this.resetProblems()},addJudgeRow:function(a,b){var c=jQuery(this.judge_tmpl(a)),d=b?c.children("td").children("div"):jQuery();c.find(".judge-remove").bind("click",this.removeJudge.bind(this));c.find(".judge-may-clarify").bind("change",this.updateJudge.bind(this));
d.attr("style","display: none;");this.tbodyJudge.append(c);d.slideDown("fast")},removeJudge:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var c=b.closest("tr");a={short_name:this.data.short_name,username:c.attr("data-username"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(){c.children("td").children("div").slideUp("fast",function(){c.remove()})}).fail(function(a){b.prop("disabled",
!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},updateJudge:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var c=b.closest("tr");a={short_name:this.data.short_name,username:c.attr("data-username"),may_clarify:c.find(".judge-may-clarify").is(":checked"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_judge,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){b.prop("disabled",!1)}).done(function(a){c.find(".judge-username a").text(a.username).attr("href",
a.profile_url);c.find(".judge-name").text(a.name);c.find(".judge-may-clarify").prop("checked",a.may_clarify)}).fail(function(a){var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},addTeamRow:function(a,b,c){var d=tmpl("team_tmpl"),e=tmpl("team_member_tmpl"),f=jQuery(d(a));a.members.forEach(function(a){var c=jQuery(e(a));c.find(".team-member-remove").bind("click",this.removeTeamMember.bind(this));f.find("li.team-member-add").before(c);a.accepted||(!0===b?jQuery("#pending-invitation-info").slideDown("fast"):
jQuery("#pending-invitation-info").show())},this);!0===c?f.find(".show-no-edit").hide():f.find(".show-edit").hide();f.find(".team-member-accepted").prop("checked",this.autoaccept);f.find(".team-edit").bind("click",function(){jQuery(this).closest("tr").find(".show-edit, .show-no-edit").toggle()});f.find(".team-done").bind("click",this.updateTeam.bind(this));f.find(".team-name").keypress(function(a){var c=f.find("button.team-done");13===a.keyCode&&!c.prop("disabled")&&c.click()});f.find(".team-remove").bind("click",
this.removeTeam.bind(this));f.find("button.team-member-add").bind("click",this.onAddTeamMember.bind(this));f.find("input.team-member-username").bind("change keyup input",function(){f.find("button.team-member-add").prop("disabled",""===jQuery(this).val())});f.find("input.team-member-username").keyup(function(a){var c=f.find("button.team-member-add");13==a.keyCode&&!c.prop("disabled")&&c.click()});this.tbodyTeam.append(f);!0===c&&f.find(".team-member-username").focus()},onAddTeamMember:function(a){var b=
jQuery(a.target),c=b.closest("li");b.prop("disabled",!0);var d=b.closest("tr");a={team_id:d.attr("data-team-id"),username:c.find("input.team-member-username").val(),accepted:this.autoaccept,csrf_token:this.data.csrf_token};jQuery.ajax({type:"POST",url:Kattis.API.ajax_session_team_member,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){d.find("input.team-member-username").focus()}).done(function(a){a=jQuery(this.team_member_tmpl(a.response.team_member));a.find(".team-member-remove").bind("click",
this.removeTeamMember.bind(this));c.before(a);d.find("input.team-member-username").val("");a.accepted||jQuery("#pending-invitation-info").slideDown("fast")}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},removeTeam:function(a){var b=jQuery(a.target),c=b.closest("tr"),d=c.find(":input");d.prop("disabled",!0);a={short_name:this.data.short_name,team_id:c.attr("data-team-id"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",
url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(){c.children("td").children("div").slideUp("fast",function(){c.remove()});jQuery('[data-invitation-state="pending"]').length||jQuery("#pending-invitation-info").slideUp("fast")}).fail(function(a){d.prop("disabled",!1);c.find("button.team-member-add").prop("disabled",""==c.find(".team-member-username").val());var f=b.data("fail-msg");Kattis.error.show_msg(f+": ",a.responseJSON.error.code)})},
updateTeam:function(a){var b=jQuery(a.target),c=b.closest("tr"),d=c.find(":input");d.prop("disabled",!0);a={short_name:this.data.short_name,team_id:c.attr("data-team-id"),team_name:c.find("input.team-name").val(),csrf_token:this.data.csrf_token};this.data.is_privileged&&(a.penalty_adjustment=c.find("input.team-penalty").val());jQuery.ajax({type:"PUT",url:Kattis.API.ajax_session_team,contentType:"application/json",data:JSON.stringify(a),context:this}).always(function(){d.prop("disabled",!1);c.find("button.team-member-add").prop("disabled",
""==c.find(".team-member-username").val());c.find(".show-edit, .show-no-edit").toggle()}).done(function(a){a=a.response.team;c.find("input.team-name").val(a.team_name);c.find("span.team-name").text(a.team_name);this.data.is_privileged&&(c.find("input.team-penalty").val(a.penalty_adjustment),c.find("span.team-penalty").text(a.penalty_adjustment))}).fail(function(a){var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)})},removeTeamMember:function(a){var b=jQuery(a.target);
b.prop("disabled",!0);var c=b.closest("li");a={team_id:b.closest("tr").attr("data-team-id"),username:c.attr("data-username"),csrf_token:this.data.csrf_token};jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_session_team_member,contentType:"application/json",data:JSON.stringify(a),context:this}).done(function(){c.remove();jQuery('[data-invitation-state="pending"]').length||jQuery("#pending-invitation-info").slideUp("fast")}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+
": ",a.responseJSON.error.code)})}});jQuery.extend(jQuery.ns("Kattis.views.contest.resolver"),{init:function(){var a=this.data,b=a.info,c=b.length,d=b.cutoff;jQuery(function(b){function f(a){return b(s.document.getElementById(a))}function g(){b(".team_problem_cell").css("width",f("resolver_cell_width").val()+"px")}function k(a,c){b("html, body").stop().animate({scrollTop:a.offset().top-b(window).height()/2+a.height()/2},200,function(){c&&c()})}function m(a,f){for(var g=b(C({team:a,problems:f})),h=g.children(".rank"),k=g.children(".score"),
l=g.children(".time"),m=g.children(".team_problem_cell"),p={},n=0;n<f.length;n++)p[f[n].id]={cell:b(m[n]),score:0,submissions:0,pending:[],last_improvement:0,max_score:f[n].max_score};return{id:a.id,name:a.name,row:g,cur_row:g,no_cell:h,points_cell:k,time_cell:l,problems:p,points:0,get_last_improvement:function(){for(var a=0,c=0;c<w.length;c++)a=Math.max(a,this.problems[w[c]].last_improvement);return a},reset:function(){this.no_cell.text("");this.points_cell.text("0");this.time_cell.text("0");for(var a=
this.points=0;a<w.length;a++){var c=w[a];this.problems[c].score=0;this.problems[c].submissions=0;this.problems[c].last_improvement=0;this.problems[c].pending=[];this.problems[c].cell.empty();this.problems[c].cell.removeClass("solved attempted partial-score pending")}},handle_submission:function(a,b,e){if(!a.judged)return!1;var f=this.problems[a.problem];if("CE"===a.result||1E-9>Math.abs(f.score-f.max_score))return!1;var g=a.time>=(c-d)/60;if(!g||b)f.submissions++,this.points-=f.score,a.score>f.score+
1E-9?(f.score=a.score,f.last_improvement=Math.floor(a.time)):1E-9>Math.abs(a.score-f.score)&&(f.last_improvement=Math.min(f.last_improvement,Math.floor(a.time))),this.points+=f.score;if(g)if(b){for(b=0;b<f.pending.length&&f.pending[b]!==a;)b++;b<f.pending.length&&(f.pending[b]=f.pending[f.pending.length-1],f.pending.pop());f.pending.sort(function(a,c){return c.time-a.time})}else f.pending.push(a);e||(this.points_cell.text(this.points),this.time_cell.text(this.get_last_improvement()),f.cell.html(f.score+
"<br/>"+f.submissions+(0<f.pending.length?"+"+f.pending.length:"")),f.cell.removeClass("solved attempted partial-score pending"),1E-9>Math.abs(f.score-f.max_score)?f.cell.addClass("solved"):0<f.pending.length?f.cell.addClass("pending"):0===f.score?f.cell.addClass("attempted"):f.cell.addClass("partial-score"));return!0}}}function l(a,c,d,f,g,h){for(var k=f.offset(),l=f.height(),m=f.width(),n=[],r=0;2>r;r++)n.push(b("<tr></tr>").append(b("<td></td>",{colspan:4+p.length}).css({height:"0",margin:"0",
padding:"0"})));n[0].height(0).width(m);f.replaceWith(n[1]);a.cur_row=n[1];n[1].height(l).width(m);f.height(l).width(m);var q=b("<div></div>");q.append(b("<table></table>").addClass("table table-kattis kattis-table-contest-standings").css({"border-top":"none","border-radius":"none"}).append(b("<tbody></tbody>").append(f))).width(m).height(l).css({position:"absolute",top:k.top+"px",left:k.left+1+"px"}).appendTo(b("#wrapper"));0===g?n[0].prependTo(b("#standings tbody")):n[0].insertAfter(d[g-1].row);
a.cur_row=n[0];n[1].animate({height:"0"},c);n[0].animate({height:l},c);q.animate({top:n[0].offset().top+"px"},c,function(){f.width("auto").height("auto");n[0].replaceWith(f);a.cur_row=f;q.remove();n[1].remove();h&&h()})}function h(a,c,d){a.sort(function(a,c){if(a.points!==c.points)return c.points-a.points;var b=a.get_last_improvement(),d=c.get_last_improvement();return 1E-9<Math.abs(b-d)?b-d:a.name!==c.name?a.name.localeCompare(c.name):0});var g=0;(function B(){if(g===a.length)d&&d();else{var h=a[g].row.index()+
1,k=g+1;0<a[g].points?a[g].no_cell.text(k):a[g].no_cell.text("");k<h?c?(h=parseInt(f("resolver_row_animate_time").val(),10)*(Math.abs(k-h)+1),l(a[g],h,a,a[g].row,k-1,function(){g+=1;B()})):(a[g].row.detach(),1===k?a[g].row.prependTo(b("#standings tbody")):a[g].row.insertAfter(a[g-1].row),g+=1,B()):(g+=1,B())}})()}var s=window.open("","Kattis Resolver","width=450, height=400");s.document.open();s.document.write(b("#resolver_controls_wrapper").html());s.document.title="Controls";f("resolver_cell_width").change(g);
var n=tmpl("table_header_tmpl"),C=tmpl("team_row_tmpl"),t=n({all_captions:!0,problems:a.problems});b("#standings thead").append(t);for(var p=a.problems,w=[],t=0;t<a.problems.length;t++)w.push(a.problems[t].id);for(var y={},F=[],u=[],t=0;t<a.teams.length;t++){var q=new m(a.teams[t],p);y[q.id]=q;F.push(q.id);b("#standings tbody").append(q.row);u.push(q)}b("#standings tbody").append(n({all_captions:!1,problems:a.problems}));n=a.runs;n.sort(function(a,c){return a.time-c.time});for(var z=[],t=0;t<n.length;t++)q=
y[n[t].team],y[n[t].team].handle_submission(n[t],!0,!0)&&z.push(n[t]);var r=function(a){function c(){for(var a=0;a<s.length;a++)f(s[a]).prop("disabled",!0).css("color","gray")}function d(){var c={};0<g&&!q&&(c.resolver_reset=!0);g<a.length&&(q?c.resolver_playback_pause=!0:(c.resolver_playback_step=!0,c.resolver_playback_play=!0,c.resolver_playback_skip=!0));g>=a.length&&0<=l&&(q?c.resolver_resolve_pause=!0:(c.resolver_resolve_step=!0,c.resolver_resolve_play=!0));for(var b=0;b<s.length;b++){var e=
c.hasOwnProperty(s[b]);f(s[b]).prop("disabled",!e).css("color",e?"black":"gray")}}var g=0,l=u.length-1,m=0,n=!1,r=!1,q=!1,s="resolver_reset resolver_playback_step resolver_playback_play resolver_playback_pause resolver_playback_skip resolver_resolve_step resolver_resolve_play resolver_resolve_pause".split(" ");return{reset:function(){g=0;l=u.length-1;problem_at=0;b("#standings tr").removeClass("highlight");b("#standings td").removeClass("resolve-problem");r=n=!1;c();for(var a=0;a<F.length;a++)y[F[a]].reset();
h(u,!1,d)},playback_step:function(){c();var b=a[g];y[b.team].handle_submission(b,!1);g++;h(u,!0,d)},playback_skip:function(){for(c();g<a.length;){var b=a[g];y[b.team].handle_submission(b,!1);g++}h(u,!1,d)},playback_play:function(){function b(){n||(l.playback_stop=null,q=!1,d())}function e(){return 6E4*(a[g].time-(0===g?0:a[g-1].time))*parseFloat(f("resolver_time_multiplier").val())}function k(){if(m){var c=a[g];y[c.team].handle_submission(c,!1);g++;n=!0;h(u,!0,function(){n=!1;g<a.length&&m?p=setTimeout(k,
e()):b()})}else b()}q=!0;var l=this,m=!0,n=!1,p=null;this.playback_pause=function(){m=!1;c();clearTimeout(p);b()};p=setTimeout(k,e());d()},resolve_step:function(a,b){function e(){a||d();b&&b()}a||c();if(n)if(r){for(var f=u[l].problems[w[m]],g=f.score,q=-1,s=0;s<f.pending.length;s++)if(f.pending[s].score>g&&(0>q||f.pending[s].score<q))q=f.pending[s].score;q=Math.max(q,0);a:for(;;){for(s=0;s<f.pending.length;s++)if(f.pending[s].score<=q){u[l].handle_submission(f.pending[s],!0);continue a}break}var t=
u[l].row;u[l].problems[w[m]].cell.removeClass("resolve-problem");k(u[l].row);h(u,!0,function(){t.removeClass("highlight");n=!0;r=!1;m=0;u[l].row.addClass("highlight");e()})}else{for(;m<p.length&&!(0<u[l].problems[w[m]].pending.length);)m++;m<p.length?(u[l].problems[w[m]].cell.addClass("resolve-problem"),r=!0):(u[l].row.removeClass("highlight"),l--,m=0,0<=l&&(u[l].row.addClass("highlight"),n=!0,r=!1));0<=l&&k(u[l].row);e()}else u[l].row.addClass("highlight"),k(u[l].row),n=!0,e()},resolve_play:function(a){function b(){k||
(g.resolve_stop=null,q=!1,d())}function e(){h?(k=!0,g.resolve_step(!0,function(){k=!1;l>=a?m=setTimeout(e,parseInt(f("resolver_resolve_timestep").val(),10)):b()})):b()}if(!(l<a)){q=!0;var g=this,h=!0,k=!1,m=null;this.resolve_pause=function(){h=!1;c();clearTimeout(m);b()};d();e()}}}}(z);r.reset();f("resolver_controls").submit(function(){return!1});f("resolver_reset").click(function(){r.reset()});f("resolver_playback_step").click(function(){r.playback_step()});f("resolver_playback_play").click(function(){r.playback_play()});
f("resolver_playback_pause").click(function(){r.playback_pause()});f("resolver_playback_skip").click(function(){r.playback_skip()});f("resolver_resolve_step").click(function(){r.resolve_step()});f("resolver_resolve_play").click(function(){r.resolve_play(parseInt(f("resolver_resolve_play_upto").val(),10))});f("resolver_resolve_pause").click(function(){r.resolve_pause()});b(s.document).on("keydown",function(a){var c=[];39===a.keyCode?c=["resolver_playback_step","resolver_resolve_step"]:32===a.keyCode&&
(c=["resolver_playback_play","resolver_playback_pause","resolver_resolve_play","resolver_resolve_pause"]);for(a=0;a<c.length;a++){var b=f(c[a]);if(!b.prop("disabled")){b.click();break}}});g()})}});jQuery.extend(jQuery.ns("Kattis.views.submissions.create"),{init:function(){this.editors=[];this.initProblemSelector();this.initLanguageSelector();this.initProblems();this.initLanguages();this.initEditors();jQuery("#submit-solution-form").on("submit",this.setEditorValues.bind(this));var a=jQuery("#sub_files_input");a.on("change",this.onSubmissionFilesChanged.bind(this));a.on("keydown",this.onSubmissionFilesKeypressed.bind(this));a.each(function(a,c){this.update_file_list(c)}.bind(this));this.mainBox(this.data.languages._default,
this.data.form_mainclass);jQuery('[name="editor_visible"]').click(this.onSwitchToEditor.bind(this));jQuery("#file-upload").click(this.onSwitchToFileUpload.bind(this));jQuery("#cancel").click(this.onCancelClicked.bind(this))},initProblemSelector:function(){var a=this.data.is_contest?"fulltitle":"problem_name";jQuery("#problem_select").select2({placeholder:this.data.problems.placeholder,data:this.data.problems.available.map(function(b){return{id:b.problem_name,text:b[a]}})})},initLanguageSelector:function(){var a=
jQuery("#language_select");a.select2({placeholder:this.data.languages.placeholder,data:this.data.languages.available.map(function(a){return{id:a.language_name,text:a.language_name}})});a.on("change",this.onLanguageChanged.bind(this))},initProblems:function(){this.problems={};this.data.problems.available.forEach(function(a){this.problems[a.problem_name]=a.problem_name;if(this.data.is_contest){var b=a.fulltitle.split(" - ")[0].toLowerCase();this.problems[b]=a.problem_name}},this)},initLanguages:function(){this.languages=
{};this.data.languages.available.forEach(function(a){this.languages[a.language_name]=!0},this)},onLanguageChanged:function(){this.setLanguage(this.getSelectedLanguage(),"")},initEditors:function(){var a=this;jQuery(".source-code-editor").each(function(){var b=a.newEditor(this.id),c="ace/mode/"+getAceMode(a.data.languages._default);b.setTheme("ace/theme/textmate");b.getSession().setMode(c);b.setShowPrintMargin(!1);b.session.setUseWorker(!1);jQuery(this).parents("#editor_resize").resizable({handles:"se",
grid:[1E4,1],resize:function(){b.resize()}})})},mainBox:function(a,b){var c=1<this.data.filecount||1<this.editors.length,d="",e="",f=!0,g=!0,k;a=a.toLowerCase();0===a.indexOf("java")&&0!==a.indexOf("javascript")?(k="java",g=!1):0===a.indexOf("javascript")&&c?k="javascript":0===a.indexOf("pascal")?k="pascal":0===a.indexOf("php")&&c?k="php":0===a.indexOf("python")&&c?k="python":0===a.indexOf("ruby")&&c?k="ruby":0===a.indexOf("scala")?(k="scala",g=!1):0===a.indexOf("kotlin")?(k="kotlin",g=!1):f=!1;f&&
(d=this.data.main_box_msg[k].help,e=this.data.main_box_msg[k].label);k=jQuery("#mainBox");var m=k.find("#main_select");b||(0<m.length&&(b=m.val()),c&&g&&(b=this.adjustFilename(b)));c="";f&&(c=["<div class='form-group'>","<label for='main_select' title='"+d+"'>",e,"</label>","<input class='form-control' id='main_select' title='"+d+"' type='text' name='mainclass' value='"+escapeHtml(b)+"' tabindex='4' />","</div>"].join(""));k.html(c)},hideEditor:function(a){jQuery("input[name='type']").val("files");
jQuery("#editor_resize").css("display","none")},showEditor:function(a){jQuery("input[name='type']").val("editor");jQuery("#editor_resize").css("display","block")},newEditor:function(a){var b=ace.edit(a);this.editors.push({name:a,editor:b});return b},setEditorValues:function(){for(var a=this.editors,b=0;b<a.length;++b){var c=a[b].name+"_submit",d=a[b].editor.getValue();jQuery("#"+c).val(d)}},setEditorLanguage:function(a){a="ace/mode/"+getAceMode(a);for(var b=this.editors,c=0;c<b.length;++c)b[c].editor.getSession().setMode(a)},
setLanguage:function(a,b){this.setEditorLanguage(a);this.mainBox(a,b)},getSelectedLanguage:function(){return jQuery("#language_select").val()},adjustFilename:function(a){if(!jQuery("#file_dialog").is(":visible"))return a;var b=jQuery("#sub_files_input")[0].files;if(!b)return a;for(var c=0;c<b.length;c++)if(/^[Mm]ain\./.test(b[c].name))return b[c].name;for(c=0;c<b.length;c++)if(b[c].name===a)return a;return b[0]?b[0].name:a},fileDialogEnabled:function(a,b){var c=this.getSelectedLanguage();this.data.filecount=
a.files?a.files.length:1;this.mainBox(c,b||"")},editorEnabled:function(){var a=this.getSelectedLanguage();this.data.filecount=1;this.mainBox(a,"")},submitForm:function(a){"function"===typeof a.submit?a.submit():a.submit.click()},isLanguageAvailable:function(a){return!!this.languages[a]},languageFromExtension:function(a,b){var c={c:"C","c#":"C#","c++":"C++",C:"C++",cc:"C++",cpp:"C++",cs:"C#",cxx:"C++",go:"Go",hs:"Haskell",java:"Java",js:"JavaScript (Node.js)",m:"Objective-C",pas:"Pascal",php:"PHP",
pl:"Prolog",rb:"Ruby",scala:"Scala",sc:"Scala",kt:"Kotlin"};if("C"===a)return"C++";a=a.toLowerCase();if(c.hasOwnProperty(a))return c[a];if("h"===a){for(var c=!1,d=0;d<b.length;d++)"c"===b[d]&&(c=!0);return!this.isLanguageAvailable("C++")||this.isLanguageAvailable("C")&&c?"C":"C++"}return null},isPython2:function(a){if(!this.isLanguageAvailable("Python 2"))return!1;if(!this.isLanguageAvailable("Python 3"))return!0;var b=/^\s*\bprint\b *[^ (),\]]|\braw_input\b/,c=a.split("\n");if(0===a.lastIndexOf("#!",
0)){if(-1!==c[0].indexOf("python2"))return!0;if(-1!==c[0].indexOf("python3"))return!1}for(a=0;a<c.length;a++){var d=c[a],e=d.indexOf("#");-1!==e&&(d=d.substr(0,e));if(b.test(d))return!0}return!1},readFile:function(a,b){var c=b.scope||this,d=new FileReader;d.onload=function(){var a=d.result,f=a.indexOf("base64,");-1!==f?(a=atob(a.substr(f+7)),b.success.call(c,a)):b.failure.call(c)}.bind(this);d.onerror=d.onabort=function(){b.failure.call(c)};d.readAsDataURL(a)},guessProblem:function(a,b){if(a)for(var c=
0;c<a.length;c++){var d=a[c].name.toLowerCase(),e=d.indexOf(".");-1!==e&&(d=d.substr(0,e));if(this.problems.hasOwnProperty(d)){b.call(this,this.problems[d]);break}}},extractMainFromPascal:function(a,b){return/^\s*[Pp]rogram\b/.test(b)?a:null},extractMainFromJava:function(a,b){if(!/ main\s*\(/.test(b))return null;if(-1===b.indexOf("class "+a)){var c=b.match(/\bclass\s*(\w+)/);a=c?c[1]:a}c=b.match(/(?:\n|^)package +([\w.]+) *;/);return(c?c[1]+".":"")+a},extractMainFromScala:function(a,b){if(!/ main\s*\(/.test(b))return null;
if(-1===b.indexOf("class "+a)&&-1===b.indexOf("object "+a)){var c=b.match(/\b(?:class|object)\s*(\w+)/);a=c?c[1]:a}c=b.match(/(?:\n|^)package +([\w.]+)/);return(c?c[1]+".":"")+a},extractMainFromKotlin:function(a,b){if(!/\bfun\s+main\s*\(/.test(b))return null;var c=b.match(/(?:\n|^)package +([\w.]+)/);return(c?c[1]+".":"")+a},guessMain:function(a,b,c,d,e,f){for(var g=0;g<a.length;g++)if(/^[Mm]ain\.\w+$/.test(a[g].name)&&this.languageFromExtension(b[g],b)==c){f(e(a[g].name));return}var k=0,m=function(){if(k>=
a.length)f("");else{var g=a[k],h=g.name.split(".").reverse()[0]||"";k++;this.languageFromExtension(h,b)!==c?m():this.readFile(g,{success:function(a){(a=d(e(g.name),a))?f(a):m()},failure:m,scope:this})}}.bind(this);m()},guessPython:function(a,b){this.readFile(a,{success:function(a){b(this.isPython2(a)?"Python 2":"Python 3")},failure:function(){b("Python 3")},scope:this})},guessLanguage:function(a,b){function c(a){return a.split(".").slice(0,-1).join(".")}function d(a){a=c(a);return a.charAt(0).toUpperCase()+
a.slice(1)+"Kt"}function e(a){return a}for(var f=a?a.length:0,g=[],k=0;k<f;k++)g.push(a[k].name.split(".").reverse()[0]||"");for(k=0;k<f;k++){var m=a[k],l=g[k],h=this.languageFromExtension(l,g),s=b.bind(null,h);if("Java"===h){this.guessMain(a,g,h,this.extractMainFromJava,c,s);return}if("Scala"===h){this.guessMain(a,g,h,this.extractMainFromScala,c,s);return}if("Kotlin"===h){this.guessMain(a,g,h,this.extractMainFromKotlin,d,s);return}if("Pascal"===h){this.guessMain(a,g,h,this.extractMainFromPascal,
e,s);return}if(null!==h){b(h);return}if("py"===l){this.guessPython(m,b);return}}b()},update_file_list:function(a){var b=jQuery(a).parent();b.removeClass("has_files");if(0!==a.files.length){b.addClass("has_files");b=b.find(".file_list");b.empty();for(var c=0;c<a.files.length;++c)b.append(jQuery("<li/>").text(a.files[c].name))}},onSubmissionFilesChanged:function(a){var b=a.target;this.hideEditor(this.data.editor_id);jQuery("#cancel").prop("disabled",!1);this.guessLanguage(b.files,function(a,c){if(a&&
this.isLanguageAvailable(a)){var f=jQuery("#language_select");f.val(a);f.trigger("change")}this.fileDialogEnabled(b,c)}.bind(this));var c=jQuery("#problem_select");c&&!c.val()&&this.guessProblem(b.files,function(a){c.val(a);c.trigger("change")});this.update_file_list(b)},onSubmissionFilesKeypressed:function(a){13===a.which&&a.ctrlKey&&this.submitForm(a.target.form)},onSwitchToEditor:function(){this.showEditor(this.data.editor_id);jQuery("#file_dialog").hide();jQuery("#editor_dialog").show();jQuery("#cancel").prop("disabled",
!1);this.editorEnabled()},onSwitchToFileUpload:function(){this.hideEditor(this.data.editor_id);jQuery("#file_dialog").show();jQuery("#editor_dialog").hide();jQuery("#cancel").prop("disabled",!0)},onCancelClicked:function(){window.location=this.data.location}});jQuery.extend(jQuery.ns("Kattis.views.recruiting.view_candidate"),function(){var a={MIN_DIFFICULTY:1,MAX_DIFFICULTY:10,PDF_CURVE_STEPS:30,init:function(){this.checkModalDialogs();this.data.has_recruiter_rights||this.drawGraph();this.initTests()},checkModalDialogs:function(){["#assign-tasks","#request-ratings","#request-test"].forEach(function(a){window.location.hash===a&&jQuery(a).modal("show")})},initTests:function(){var a=jQuery("#test-summary");a.circliful();0!=this.data.tests.length&&jQuery(".circle-text-half").replaceWith(function(){var b=
jQuery.trim(jQuery(this).text()),e=jQuery.trim(a.data("link"));e&&(b='<a href="'+e+'">'+b+"</a>");return'<span class="circle-text-half" style="line-height: 179.31px; font-size: 40px;">'+b+"</span>"})},getPixelRatio:function(a){return(window.devicePixelRatio||1)/(a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)},rayleigh:function(a){var b=Math.pow(2.8385,2);return a/b*Math.exp(-(a*
a)/(2*b))},renderPDFcurve:function(a,b){for(var e=[],f=0,g=0;g<this.PDF_CURVE_STEPS;++g){var k=(this.MAX_DIFFICULTY-this.MIN_DIFFICULTY)*g/this.PDF_CURVE_STEPS+this.MIN_DIFFICULTY,m=this.rayleigh(k),f=Math.max(f,m);e.push([k,m])}var l=a.height,h=a.width;b.translate(0,-77.5);b.beginPath();b.moveTo(0,l);for(g=0;g<e.length;++g)k=e[g][0]*h/(this.MAX_DIFFICULTY-this.MIN_DIFFICULTY+1),m=l-0.9*(e[g][1]*(l-77.5)/f),b.lineTo(k,m);b.lineTo(k,l);b.closePath();b.fillStyle="#E7E7E7";b.fill()},drawGraphTail:function(a,
b){if(this.data.is_set_hardest_accepted){var e=a.height,f=a.width;b.globalCompositeOperation="source-atop";b.beginPath();var g=this.data.hardest_accepted_array,k=this.data.hardest_accepted_after;b.moveTo(g.problem_difficulty*(f/10)-50,50);b.lineTo(k.problem_difficulty*(f/10)-50,50);b.lineTo(k.problem_difficulty*(f/10)-50,e);b.lineTo(g.problem_difficulty*(f/10)-50,e);b.closePath();b.fillStyle="#449fe1";b.fill();b.globalCompositeOperation="source-over"}},drawBreakpoint:function(a,b){for(var e=a.height,
f=a.width,g=[this.data.recommendation_limit],k=[],m=0;m<g.length;m++)k.push(g[m]*(f/10)-50);for(m=0;m<k.length;m++)b.beginPath(),b.lineWidth=10,b.strokeStyle="black",b.moveTo(k[m],20),b.lineTo(k[m],e),b.strokeStyle="#f0b034",b.stroke()},drawXAxisTicks:function(a,b){for(var e=a.height,f=a.width,g=1;g<=this.MAX_DIFFICULTY;g++)b.font="bold 24px Arial",b.fillStyle="#1E1E1E",b.fillText(g,f/10*g-57,e+36)},drawProblemsInfo:function(a,b){for(var e=a.height,f=a.width,g=[],k=[],m=[],l=0;l<this.data.values_to_plot.length;++l){var h=
this.data.values_to_plot[l];g.push(h.problem_difficulty);!0==h.solved?m.push("#52BB50"):!1==h.solved?m.push("#F20708"):m.push("#C7C7C7")}for(l=0;l<g.length;l++)k.push(g[l]*(f/10)-50);for(var s=this.data.height_top_offset,l=0;l<k.length;l++)b.beginPath(),b.lineWidth=2,b.strokeStyle="black",b.moveTo(k[l],s),b.lineTo(k[l],e),b.stroke();k.forEach(function(a,c){b.beginPath();b.arc(a,s,10,0,2*Math.PI,!1);b.fillStyle=m[c];b.fill();b.lineWidth=2;b.stroke()})},drawGraph:function(){var a=this.data.initial_width,
b=document.getElementById("curve"),e=b.getContext("2d");b.width=2*a;b.height=360;b.style.width=a+"px";b.style.height="180px";e.scale(this.getPixelRatio,this.getPixelRatio);this.renderPDFcurve(b,e);this.drawXAxisTicks(b,e);this.drawGraphTail(b,e);this.drawBreakpoint(b,e);this.drawProblemsInfo(b,e)}},b=!1;return{init:function(){b||(b=!0,a.data=this.data,this.data=null,a.init())}}}());jQuery.extend(jQuery.ns("Kattis.views.admin.course_offering_edit"),function(){var a={init:function(){this.createBtn=jQuery(".create-btn");jQuery(".field_toggle_null").on("change",this.onCheckboxClick.bind(this));jQuery("#offering_offering_short_name").on("keyup input",this.onOfferingShortNameChanged.bind(this));jQuery("#offering_offering_end").on("change keyup input",this.onOfferingEndChanged.bind(this));jQuery("#offering_offering_registration_key").on("change keyup input",this.onRegistrationKeyChanged.bind(this));
jQuery(".course-offering-form input[pattern], .course-offering-form input[type=checkbox]").on("change keyup input",this.onFormFieldChanged.bind(this));this.initTeachers();this.initProblemgroups()},initTeachers:function(){this.teacher_tbody=jQuery(".table-teachers tbody");this.teacher_tmpl=tmpl("teacher_tmpl");jQuery(".add-teacher-btn").on("click",this.onAddTeacher.bind(this));jQuery(".add-teacher-username").bind("change keyup input",function(){jQuery(".add-teacher-btn").prop("disabled",""===jQuery(this).val())});
jQuery(".add-teacher-username").keypress(function(a){if(13==a.keyCode&&!jQuery(".add-teacher-btn").prop("disabled"))return jQuery(".add-teacher-btn").click(),a.preventDefault(),!1});this.data.teachers.forEach(function(a,b){this.addTeacherRow({teacher_no:b,name:a.name,username:a.username,link:Kattis.API.user_view+"/"+a.username},!1)},this);this.teacher_no=this.data.teachers.length},initProblemgroups:function(){this.problemgroup_tbody=jQuery(".table-problemgroups tbody");this.problemgroup_tmpl_old=
tmpl("problemgroup_tmpl_old");this.problemgroup_tmpl_new=tmpl("problemgroup_tmpl_new");jQuery(".add_problemgroup").on("click",this.onAddProblemGroup.bind(this));jQuery("#input_problem_group_name").select2({allowClear:!0,createSearchChoice:function(a,b){if(0===jQuery(b).filter(function(){return 0===this.text.localeCompare(a)}).length)return{id:"0",text:a,exists:!1}},data:[],formatResult:function(a,b,e,f){return a.exists?f(a.text):f(a.text)+" <i>(new)</i>"}});this.data.problemgroups.forEach(function(a,
b){var e="";a.id&&(e=Kattis.API.course_problemgroup_edit.replace("{0}",this.data.course_short_name).replace("{1}",this.data.offering_short_name).replace("{2}",a.id));this.addProblemgroupRow({problemgroup_no:b,id:a.id,name:a.name,link:e},!1)},this);this.problemgroup_no=this.data.problemgroups.length},addTeacherRow:function(a,b){var e=jQuery(this.teacher_tmpl(a)),f=b?e.children("td"):jQuery();e.find(".remove-teacher-btn").bind("click",this.onRemoveTeacher.bind(this));f.attr("style","display: none;");
this.teacher_tbody.append(e);f.slideDown("fast")},addProblemgroupRow:function(a,b){var e=jQuery((void 0===a.id?this.problemgroup_tmpl_new:this.problemgroup_tmpl_old)(a)),f=b?e.children("td"):jQuery();e.find(".remove-problemgroup-btn").bind("click",this.onRemoveProblemGroup.bind(this));f.attr("style","display: none;");this.problemgroup_tbody.append(e);f.slideDown("fast")},removeTableRow:function(a){a.children("td").slideUp("fast",function(){a.remove()})},isValid:function(){for(var a=jQuery(".course-offering-form input[pattern]:not([disabled])").toArray(),
b=jQuery(".course-offering-form .form-group.has-error"),e=jQuery(".course-offering-form span.fa"),b=0==b.length&&0==e.length,e=0;e<a.length;++e)var f=jQuery(a[e]),b=b&this.isPatternFieldValid(f);return b},updateCreateBtn:function(){this.createBtn.prop("disabled",!this.isValid())},onFormFieldChanged:function(a){9==a.keyCode||16==a.keyCode||(jQuery(a.target).closest("div.form-group").addClass("has-warning"),this.updateCreateBtn())},toggleInputValidation:function(a,b){a.parents(".form-group").toggleClass("has-error",
!b)},isPatternFieldValid:function(a){return RegExp(a.attr("pattern")).test(a.val())},validatePatternField:function(a){var b=this.isPatternFieldValid(a);this.toggleInputValidation(a,b);return b},onRegistrationKeyChanged:function(a){this.validatePatternField(jQuery(a.target))},onOfferingEndChanged:function(a){a=jQuery(a.target);var b=a.val();this.validatePatternField(a)&&(b="infinity"==b||Kattis.util.isValidDate(b),this.toggleInputValidation(a,b))},onOfferingShortNameChanged:function(a){var b=jQuery(a.target),
e=b.parent().children("span"),f=b.val();this.call_id=(this.call_id||0)+1;this.hintTimeout&&(clearTimeout(this.hintTimeout),this.hintTimeout=null);this.validatePatternField(b)?this.data.offering_short_name==f?(e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success"),this.toggleInputValidation(b,!0)):(e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success").addClass("fa fa-spinner fa-spin"),
this.createBtn.prop("disabled",!0),this.hintTimeout=setTimeout(function(a){jQuery.ajax({type:"GET",url:Kattis.API.ajax_course_offering_short_name_available,data:{course_short_name:this.data.course_short_name,offering_short_name:f},context:this}).always(function(){e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success")}).done(function(c){a===this.call_id&&(this.toggleInputValidation(b,c.response.available),e.addClass(c.response.available?"glyphicon glyphicon-ok text-success":
"glyphicon glyphicon-remove text-danger"),this.updateCreateBtn())}).fail(function(){a===this.call_id&&(this.toggleInputValidation(b,!1),e.addClass("glyphicon glyphicon-remove text-danger"),this.updateCreateBtn())})}.bind(this),750,this.call_id)):e.removeClass("fa fa-spinner fa-spin glyphicon glyphicon-remove text-danger glyphicon glyphicon-ok text-success")},onCheckboxClick:function(a){var b=jQuery(a.target);a=b.prop("checked");b=b.data("toggleid");b=jQuery("#"+b);b.prop("disabled",!a);a?this.validatePatternField(b):
this.toggleInputValidation(b,!0)},onRemoveTeacher:function(a){var b=jQuery(a.target);b.prop("disabled",!0);var e=b.closest("tr");this.data.is_new?(this.removeTableRow(e),e.closest("div.form-group").addClass("has-warning"),this.updateCreateBtn()):(a={course_short_name:this.data.course_short_name,offering_short_name:this.data.offering_short_name,user_name:e.attr("data-username"),csrf_token:this.data.csrf_token},jQuery.ajax({type:"DELETE",url:Kattis.API.ajax_course_offering_teacher,contentType:"application/json",
data:JSON.stringify(a),context:this}).done(function(){this.removeTableRow(e)}).fail(function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)}))},onAddTeacher:function(a){var b=jQuery(a.target),e=jQuery(".add-teacher-username");a=e.val();b.prop("disabled",!0);var f={always:function(){e.focus()},done:function(a){e.val("");this.addTeacherRow({teacher_no:this.teacher_no++,username:a.response.username,name:a.response.name,link:Kattis.API.user_view+
"/"+a.response.username},!0);this.data.is_new&&(e.closest("div.form-group").addClass("has-warning"),this.updateCreateBtn())},fail:function(a){b.prop("disabled",!1);var c=b.data("fail-msg");Kattis.error.show_msg(c+": ",a.responseJSON.error.code)},scope:this};this.data.is_new?this.getAuthor(a,f):this.postTeacher(a,f)},postTeacher:function(a,b){jQuery.ajax({type:"POST",url:Kattis.API.ajax_course_offering_teacher,contentType:"application/json",data:JSON.stringify({course_short_name:this.data.course_short_name,
offering_short_name:this.data.offering_short_name,user_name:a,csrf_token:this.data.csrf_token}),context:b.scope||this}).always(b.always).done(b.done).fail(b.fail)},getAuthor:function(a,b){jQuery.ajax({type:"GET",url:Kattis.API.ajax_author,contentType:"application/json",data:{username:a},context:b.scope||this}).always(b.always).done(b.done).fail(b.fail)},onRemoveProblemGroup:function(a){a=jQuery(a.target);this.removeTableRow(a.closest("tr"));a.closest("div.form-group").addClass("has-warning");this.updateCreateBtn()},
onAddProblemGroup:function(){var a=jQuery("#input_problem_group_name"),b=a.select2("data"),e=b.id,b={name:b.text,problemgroup_no:this.problemgroup_no++};"0"!=e&&(b.id=e,b.link=Kattis.API.course_problemgroup_edit.replace("{0}",this.data.course_short_name).replace("{1}",this.data.offering_short_name).replace("{2}",e));this.addProblemgroupRow(b,!0);a.closest("div.form-group").addClass("has-warning");this.updateCreateBtn();a.select2("val","")}},b=!1;return{init:function(){b||(b=!0,a.data=this.data,this.data=
null,a.init())}}}());jQuery.extend(jQuery.ns("Kattis.main"),{init:function(){jQuery(".selectify-this").select2();jQuery('[data-toggle="tooltip"]').tooltip();jQuery(".site-search > a").on("click",function(){jQuery(this).parent().find("input").focus()});jQuery(".site-search > input").on("focus",function(){jQuery(this).parent().addClass("active")});jQuery("body").on("click",function(a){jQuery(".site-search").each(function(){!jQuery(this).is(a.target)&&0===jQuery(this).has(a.target).length&&jQuery(this).removeClass("active")})});
jQuery("#filter li a").click(function(a){a=jQuery(this).text();var b=jQuery(this).parent().attr("data-value");jQuery("#main_filter_text").text(a);jQuery("#filter_by").val(b);"all"===b?jQuery("#filter_by_value").prop("disabled",!0):jQuery("#filter_by_value").prop("disabled",!1).focus()})}});var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeHtml(a){return String(a).replace(/[&<>"'\/]/g,function(a){return entityMap[a]})}
function twodigit(a){return(10>a?"0":"")+a}function format_interval(a,b,c){b="undefined"!==typeof b?b:!1;var d=0>a;d&&(a=-a);a=Math.floor(a);var e=Math.floor(a/3600),f=Math.floor(a/60)%60;a%=60;var g="";"undefined"!==typeof c&&c&&(c=Math.floor(e/24),e%=24,0<c&&(b=!0,g+=c+" day"+(1!=c?"s":"")+" "));if(0<e||b)g+=e+":";g+=twodigit(f)+":"+twodigit(a);d&&(g="-"+g);return g}
function initContestHeader(a,b,c){var d=window.page_loaded_at;jQuery(function(e){var f=e(".contest-progress"),g=function(a,b){b&&!f.hasClass(a)?f.addClass(a):!b&&f.hasClass(a)&&f.removeClass(a)},k=-600;b<k&&(k=-(300+300*Math.random()));var m=b<k,l=2>b;setInterval(function(){var e=Math.floor(b+(new Date-d)/1E3),s=e<k,n=2>e;a&&(l&&!n||m&&!s)&&location.reload();m=s;l=n;var C=n=!1,t=!1,s=!1;a?0>e?t=!0:e>=c?C=!0:900>=c-e&&(n=!0):(s=!0,e=0);g("session-nostart",s);g("session-notstarted",t);g("session-nearend",
n);g("session-finished",C);0>e&&f.find(".countdown").text(format_interval(-e,!1,!0));e=Math.max(0,e);e=Math.min(c,e);n=0;s||(n=100*e/c);f.find(".count_elapsed").text(format_interval(e,!0));f.find(".count_remaining").text(format_interval(c-e,!0));f.find(".progress-bar").css("width",n.toString()+"%")},1E3)});return function(e,f,g,k){a=e;b=f;c=g;d=k}}
jQuery.extend(jQuery.ns("Kattis"),function(){var a={"page-master-layout":Kattis.main,"page-contest-edit":Kattis.views.contest.edit,"page-contest-resolver":Kattis.views.contest.resolver,"page-submit":Kattis.views.submissions.create,"page-view-candidate":Kattis.views.recruiting.view_candidate,"page-course-offering-edit":Kattis.views.admin.course_offering_edit};return{init:function(){document.body.attributes["class"].value.split(/\s+/g).forEach(this.run_module,this)},run_module:function(b){a[b]&&a[b].init.call(a[b])}}}());
jQuery(Kattis.init.bind(Kattis));
